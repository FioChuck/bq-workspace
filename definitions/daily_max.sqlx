config { 
  type: "table",
  assertions: {
    rowConditions: [
      'dt is not null',
      'temp < 70'
    ]
  }
}

-- define table
SELECT
  MAX(tempinf) AS temp,
  MAX(humidityin) AS humidity,
  COUNT(*) as samples,
  EXTRACT(DATE
  FROM
    processingtime) AS dt
FROM
  `cf-data-analytics.sensor_data.eccowitt_stream`
GROUP BY
  dt
ORDER BY
  dt desc